// sidebar.component.html

<div class="sidebar" [class.collapsed]="isCollapsed" [class.expanded]="!isCollapsed">
    <header class="sidebar-header">
        <!-- App branding in both collapsed and expanded states -->
        <div class="brand">
            <div class="logo-container">
                <i class="logo-icon bi bi-grid-1x2"></i>
                <span class="logo-text" *ngIf="!isCollapsed">Admin Dashboard</span>
            </div>
            <button class="collapse-toggle" (click)="toggleCollapse()" aria-label="Toggle sidebar">
                <i class="bi" [ngClass]="isCollapsed ? 'bi-chevron-right' : 'bi-chevron-left'"></i>
            </button>
        </div>
    </header>

    <!-- Main navigation -->
    <nav class="sidebar-nav" aria-label="Main navigation">
        <!-- Primary navigation items -->
        <div class="nav-group">
            <div class="nav-group-label" *ngIf="!isCollapsed">Main</div>

            <a class="nav-item" routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                <i class="nav-icon bi bi-house"></i>
                <span class="nav-label" *ngIf="!isCollapsed">Dashboard</span>
            </a>

            <!-- Navigation item with children -->
            <div class="nav-item-with-children">
                <button class="nav-item" [class.active]="isGroupActive('products')"
                    [class.expanded]="expandedGroups.has('products')" (click)="toggleGroup('products')">
                    <i class="nav-icon bi bi-box"></i>
                    <span class="nav-label" *ngIf="!isCollapsed">Products</span>
                    <i class="nav-expand-icon bi" *ngIf="!isCollapsed"
                        [ngClass]="expandedGroups.has('products') ? 'bi-chevron-down' : 'bi-chevron-right'">
                    </i>
                </button>

                <!-- Submenu items -->
                <div class="nav-children" [class.visible]="expandedGroups.has('products') && !isCollapsed">
                    <a class="nav-child-item" routerLink="/products/list" routerLinkActive="active">
                        <i class="nav-icon bi bi-list-ul"></i>
                        <span class="nav-label">List Products</span>
                    </a>
                    <a class="nav-child-item" routerLink="/products/add" routerLinkActive="active">
                        <i class="nav-icon bi bi-plus-circle"></i>
                        <span class="nav-label">Add Product</span>
                    </a>
                    <a class="nav-child-item" routerLink="/products/categories" routerLinkActive="active">
                        <i class="nav-icon bi bi-tags"></i>
                        <span class="nav-label">Categories</span>
                    </a>
                </div>
            </div>

            <!-- Direct navigation items -->
            <a class="nav-item" routerLink="/orders" routerLinkActive="active">
                <i class="nav-icon bi bi-cart"></i>
                <span class="nav-label" *ngIf="!isCollapsed">Orders</span>
                <span class="nav-badge" *ngIf="newOrdersCount > 0">{{newOrdersCount}}</span>
            </a>

            <a class="nav-item" routerLink="/statistics" routerLinkActive="active">
                <i class="nav-icon bi bi-graph-up"></i>
                <span class="nav-label" *ngIf="!isCollapsed">Statistics</span>
            </a>
        </div>

        <!-- Secondary navigation group -->
        <div class="nav-group">
            <div class="nav-group-label" *ngIf="!isCollapsed">System</div>

            <a class="nav-item" routerLink="/settings" routerLinkActive="active">
                <i class="nav-icon bi bi-gear"></i>
                <span class="nav-label" *ngIf="!isCollapsed">Settings</span>
            </a>

            <a class="nav-item" routerLink="/users" routerLinkActive="active">
                <i class="nav-icon bi bi-people"></i>
                <span class="nav-label" *ngIf="!isCollapsed">Users</span>
            </a>
        </div>
    </nav>

    <!-- User section in sidebar footer -->
    <div class="sidebar-footer">
        <div class="user-menu" (click)="toggleUserMenu()">
            <div class="user-avatar">
                <img *ngIf="user?.photoUrl" [src]="user.photoUrl" alt="User avatar">
                <i class="bi bi-person-circle" *ngIf="!user?.photoUrl"></i>
            </div>
            <div class="user-info" *ngIf="!isCollapsed">
                <div class="user-name">{{user?.name || 'Guest User'}}</div>
                <div class="user-role">{{user?.role || 'No role'}}</div>
            </div>
            <i class="user-menu-toggle bi" *ngIf="!isCollapsed"
                [ngClass]="isUserMenuOpen ? 'bi-chevron-up' : 'bi-chevron-down'">
            </i>
        </div>

        <!-- User menu dropdown -->
        <div class="user-dropdown" *ngIf="isUserMenuOpen && !isCollapsed">
            <a class="user-dropdown-item" routerLink="/profile">
                <i class="bi bi-person"></i>
                <span>My Profile</span>
            </a>
            <a class="user-dropdown-item" (click)="logout()">
                <i class="bi bi-box-arrow-right"></i>
                <span>Logout</span>
            </a>
        </div>

        <!-- Theme toggle in footer -->
        <button class="theme-toggle" (click)="toggleTheme()" *ngIf="!isCollapsed">
            <i class="bi" [ngClass]="isDarkTheme ? 'bi-sun' : 'bi-moon'"></i>
            <span>{{isDarkTheme ? 'Light Mode' : 'Dark Mode'}}</span>
        </button>
        <button class="theme-toggle theme-toggle-icon-only" (click)="toggleTheme()" *ngIf="isCollapsed">
            <i class="bi" [ngClass]="isDarkTheme ? 'bi-sun' : 'bi-moon'"></i>
        </button>
    </div>
</div>

<!-- Mobile navigation for responsive design -->
<nav class="mobile-nav" aria-label="Mobile navigation">
    <a class="mobile-nav-item" *ngFor="let item of mobileNavItems" [routerLink]="item.path" routerLinkActive="active">
        <i class="nav-icon" [ngClass]="item.icon"></i>
        <span class="nav-label">{{item.label}}</span>
    </a>
</nav>